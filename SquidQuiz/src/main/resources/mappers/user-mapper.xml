<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="userMapper">
	<resultMap type="User" id="userResultMap">
		<id property="userNo" column="USER_NO"/>
		<result property="userId" column="USER_ID"></result>
		<result property="userPwd" column="USER_PWD"></result>
		<result property="userName" column="USER_NAME"></result>
		<result property="userEmail" column="USER_EMAIL"></result>
		<result property="userPhone" column="USER_PHONE"></result>
		<result property="bankName" column="BANK_NAME"></result>
		<result property="bankAccount" column="BANK_ACCOUNT"></result>
		<result property="userAddr" column="USER_ADDR"/>
		<result property="point" column="POINT"></result>
		<result property="adminType" column="ADMIN_TYPE"></result>
		<result property="gameType" column="GAME_TYPE"></result>
	</resultMap>
	
	<resultMap type="Board" id="boardResultMap">
		<id property="bNo" column="BOARD_NO" />
		<result property="bTitle" column="BOARD_TITLE"/>
		<result property="bContents" column="BOARD_CONTENTS"/>
		<result property="userId" column="USER_Id"/>
		<result property="bFileName" column="BOARD_FILENAME"/>
		<result property="bFileRename" column="BOARD_FILERENAME"/>
		<result property="bfilePath" column="BOARD_FILEPATH"/>
		<result property="bCreateDate" column="BOARD_CREATE_DATE"/>
		<result property="bUpdateDate" column="BOARD_UPDATE_DATE"/>
	</resultMap>

	
	<!-- 로그인 -->
	<select id="selectLoginUser" resultMap="userResultMap">
		SELECT USER_NO, USER_ID, USER_NAME, BANK_NAME, BANK_ACCOUNT, USER_ADDR, POINT, ADMIN_TYPE, GAME_TYPE  FROM MEMBER WHERE USER_ID =#{userId } AND USER_PWD = #{userPwd }
	</select>
	
	<!-- 아이디중복확인 -->
	<select id="checkIdDup" parameterType="String" resultType="_int">
		SELECT COUNT(*) FROM MEMBER WHERE USER_ID =#{userId }
	</select>
	
	<!-- 아이디 찾기 -->
	<select id="findUserId" resultType="string">
		SELECT USER_ID FROM MEMBER WHERE USER_NAME = #{userName } AND USER_EMAIL = #{userEmail }
	</select>
	
	<!-- 비밀번호 찾기 -->
	<select id="findUserPwd" resultType="string">
		SELECT USER_PWD FROM MEMBER WHERE USER_ID = #{userId } AND USER_EMAIL = #{userEmail }
	</select>
	
	<!-- 마이페이지 포인트 조회 -->
	<select id="selectOnePoint" parameterType="string" resultMap="userResultMap">
		SELECT * FROM MEMBER WHERE USER_ID =#{userId }
	</select>
	
	<!-- 자유게시판 조회 -->
	<select id="selectBoard" resultMap="boardResultMap">
		SELECT BOARD_NO, BOARD_TITLE, BOARD_CREATE_DATE FROM BOARD WHERE USER_ID = #{userId}
	</select>
	
	<!-- 자유게시판 리스트 갯수 조회 -->
	<select id="selectBListCount" resultType="_int">
		SELECT COUNT(*) FROM BOARD
	</select>
	
	
	<!-- 회원가입db등록 -->
	<insert id="insertUser" parameterType="User">
		INSERT INTO MEMBER VALUES(SEQ_MEMBER.NEXTVAL, #{userId }, #{userPwd }, #{userName }, #{userEmail }, #{userPhone }, #{bankName }, #{bankAccount }, #{userAddr }, DEFAULT, DEFAULT, DEFAULT)
	</insert>
	
	<!-- 회원정보 수정 -->
	<update id="updateUser" parameterType="User">
		UPDATE MEMBER SET USER_PWD = #{userPwd }, USER_EMAIL = #{userEmail }, USER_PHONE = #{userPhone }, BANK_NAME =#{bankName}, BANK_ACCOUNT =#{bankAccount }, USER_ADDR = #{userAddr } WHERE USER_ID = #{userId } AND USER_ID =#{userId}
	</update>
	
	<!-- 회원탈퇴 -->
	<delete id="deleteUser" parameterType="String">
		DELETE FROM MEMBER WHERE USER_ID = #{userId } AND USER_PWD = #{userPwd }
	</delete> 
	
	
</mapper>